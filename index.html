<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculateur PSTQ ‚Äì Capital humain</title>
  <style>
  
    body { font-family: sans-serif; background: #f3f4f6; padding: 20px; }
    .container { max-width: 800px; margin: auto; background: white; padding: 20px; border-radius: 1.5rem; box-shadow: 0 4px 18px #0002; }
    h1, h2 { color: #1e293b; }
    label { font-weight: 500; margin-top: 16px; display: block; }
    select, input[type="text"], input[type="number"] {
      width: 100%; padding: 10px; margin-top: 5px; border: 1px solid #ddd; border-radius: 8px;
    }
    button {
      margin-top: 22px; padding: 12px 0; font-size: 17px;
      background: #2563eb; color: white; border: none; border-radius: 8px;
      width: 100%; font-weight: bold; box-shadow: 0 2px 8px #2563eb33; cursor: pointer;
      transition: background 0.2s;
    }
    button:hover { background: #1e40af; }
    #result, #resultat-diagnostic, #score-total { margin-top: 20px; font-size: 1.12em; }
    .card {
      max-width:450px;margin:auto;padding:1.5rem;border-radius:1.25rem;background:#f8fafc;box-shadow:0 2px 12px #0001;
      margin-bottom: 2em;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Capital humain ‚Äì Calculateur PSTQ</h1>
    
    <button type="button" onclick="resetAll()">
  R√©initialiser
</button>
    
    <label for="avecConjoint">Pr√©sentez-vous une demande :</label>
    <select id="avecConjoint" onchange="renderCapitalHumain()">
      <option value="non">Seul(e)</option>
      <option value="oui">Avec conjoint</option>
    </select>

    <form id="capitalHumain"></form>
<div id="result"></div>

    <div class="card">
      <h3 style="font-size:1.2em;margin-bottom:0.5em;">Diagnostic de main-d‚Äô≈ìuvre et exp√©rience (PSTQ)</h3>
      <label for="cnp" style="font-weight:500;">Votre code CNP (2021)</label>
      <input type="text" id="cnp" maxlength="5" required pattern="[0-9]{5}" inputmode="numeric"
        placeholder="Ex : 72410"
        style="margin-bottom:10px;">
      <small>
        <a href="https://noc.esdc.gc.ca/?GoCTemplateCulture=fr-CA" target="_blank">Trouver mon code CNP</a>
      </small>
      <br><br>
      <label for="experienceDiagnostic" style="font-weight:500;">Dur√©e d'exp√©rience dans la profession principale</label>
      <select id="experienceDiagnostic" style="margin-bottom:10px;">
        <option value="0">Moins de 12 mois</option>
        <option value="12">12 √† 23 mois</option>
        <option value="24">24 √† 35 mois</option>
        <option value="36">36 √† 47 mois</option>
        <option value="48">48 √† 60 mois</option>
      </select>
      <button type="button" onclick="calculerPointsDiagnostic()">Calculer le score diagnostic</button>
      <div id="resultat-diagnostic"></div>
    </div>
    
    <!-- COLLE CETTE SECTION ICI : -->
    <div class="card">
      <h3 style="font-size:1.2em;margin-bottom:0.5em;">Dipl√¥me du Qu√©bec et S√©jours hors Montr√©al</h3>
      <label for="diplomeQC" style="font-weight:500;">Dipl√¥me obtenu au Qu√©bec</label>
      <select id="diplomeQC" style="margin-bottom:10px;">
        <option value="">-- S√©lectionner --</option>
        <option value="secondaire">Secondaire g√©n√©ral compl√©t√©</option>
        <option value="dep_600_899">DEP/ASP 600 √† 899 heures</option>
        <option value="dep_900">DEP/ASP 900 heures ou plus</option>
        <option value="postsec_gen_2">Postsecondaire g√©n√©ral 2 ans √† temps plein</option>
        <option value="postsec_tech_900">Postsecondaire technique 900h+ (QC)</option>
        <option value="postsec_tech_3">Postsecondaire technique 3 ans √† temps plein</option>
        <option value="univ_1an">Universitaire 1er cycle 1 an √† temps plein</option>
        <option value="univ_2an">Universitaire 1er cycle 2 ans √† temps plein</option>
        <option value="univ_3_4an">Universitaire 1er cycle 3 ou 4 ans √† temps plein</option>
        <option value="univ_5an">Universitaire 1er cycle 5 ans ou plus √† temps plein</option>
        <option value="univ_2e_1an">Universitaire 2e cycle 1 an √† temps plein</option>
        <option value="univ_2e_2an">Universitaire 2e cycle 2 ans ou plus √† temps plein</option>
        <option value="univ_med_2an">Universitaire sp√©cialisation m√©dicale 2 ans ou plus √† temps plein</option>
        <option value="univ_3e">Universitaire 3e cycle</option>
      </select>

      <label for="expQC" style="font-weight:500;">Dur√©e de l'exp√©rience de travail au Qu√©bec (en mois, 5 derni√®res ann√©es)</label>
      <select id="expQC" style="margin-bottom:10px;">
        <option value="0">Moins de 12 mois</option>
        <option value="12">12 √† 23 mois</option>
        <option value="24">24 √† 35 mois</option>
        <option value="36">36 √† 47 mois</option>
        <option value="48">48 √† 60 mois</option>
      </select>

      <label for="residHorsMtl" style="font-weight:500;">Dur√©e de la r√©sidence √† l‚Äôext√©rieur de Montr√©al (en mois)</label>
      <select id="residHorsMtl" style="margin-bottom:10px;">
        <option value="0">0 √† 5 mois</option>
        <option value="6">6 √† 11 mois</option>
        <option value="12">12 √† 23 mois</option>
        <option value="24">24 √† 35 mois</option>
        <option value="36">36 √† 47 mois</option>
        <option value="48">48 mois et plus</option>
      </select>

      <label for="travHorsMtl" style="font-weight:500;">Dur√©e de l'exp√©rience de travail √† l‚Äôext√©rieur de Montr√©al (en mois)</label>
      <select id="travHorsMtl" style="margin-bottom:10px;">
        <option value="0">0 √† 5 mois</option>
        <option value="6">6 √† 11 mois</option>
        <option value="12">12 √† 23 mois</option>
        <option value="24">24 √† 35 mois</option>
        <option value="36">36 √† 47 mois</option>
        <option value="48">48 mois et plus</option>
      </select>

      <label for="etudHorsMtl" style="font-weight:500;">Dur√©e du s√©jour d‚Äô√©tudes √† l‚Äôext√©rieur de Montr√©al (en mois)</label>
      <select id="etudHorsMtl" style="margin-bottom:10px;">
        <option value="0">0 √† 5 mois</option>
        <option value="6">6 √† 11 mois</option>
        <option value="12">12 √† 23 mois</option>
        <option value="24">24 √† 35 mois</option>
        <option value="36">36 √† 47 mois</option>
        <option value="48">48 mois et plus</option>
      </select>

      <button type="button" onclick="calculerPointsQC()">Calculer les points Dipl√¥me/S√©jours hors Montr√©al</button>
      <div id="resultat-qc"></div>
    </div>
    <!-- FIN DE LA SECTION √Ä AJOUTER -->
    <div class="card">
  <h3 style="font-size:1.2em;margin-bottom:0.5em;">Offre d'emploi valid√©e & Autorisation d'exercer</h3>
  
  <label for="offreValidee" style="font-weight:500;">Avez-vous une offre d'emploi valid√©e par le ministre dans votre profession principale‚ÄØ?</label>
  <select id="offreValidee" style="margin-bottom:10px;">
    <option value="0">Non</option>
    <option value="cmm">Oui, dans la CMM (Montr√©al)</option>
    <option value="hors_cmm">Oui, hors CMM (ext√©rieur Montr√©al)</option>
  </select>

  <label for="autorisationExercer" style="font-weight:500; margin-top:16px;">
    Avez-vous une autorisation d‚Äôexercer la profession principale, ou une reconnaissance (partielle/compl√®te) de votre dipl√¥me/formation par l'autorit√© de r√©glementation au Qu√©bec‚ÄØ?
  </label>
  <select id="autorisationExercer" style="margin-bottom:10px;">
    <option value="0">Non</option>
    <option value="50">Oui</option>
  </select>

  <button type="button" onclick="calculerPointsOffre()">Calculer les points Offre/Autorisation</button>
  <div id="resultat-offre"></div>
</div>
<div class="card">
  <h3 style="font-size:1.2em;margin-bottom:0.5em;">Facteurs d‚Äôadaptation</h3>
  
  <label style="font-weight:500;">S√©jour d‚Äô√©tudes sans dipl√¥me au Qu√©bec</label>
  <select id="sejourType" style="margin-bottom:8px;">
    <option value="none">Aucun</option>
    <option value="termine">S√©jour termin√©</option>
    <option value="encours">S√©jour en cours</option>
  </select>
  <label for="dureeSejour" style="font-weight:500;">Dur√©e du s√©jour (en mois)</label>
  <select id="dureeSejour" style="margin-bottom:10px;">
    <option value="0">0 √† 5 mois</option>
    <option value="6">6 √† 11 mois</option>
    <option value="12">12 √† 23 mois</option>
    <option value="24">24 √† 35 mois</option>
    <option value="36">36 √† 47 mois</option>
    <option value="48">48 mois et plus</option>
  </select>

  <label for="parentQuebec" style="font-weight:500;">Membre de la parent√© au Qu√©bec (hors CMM)</label>
  <select id="parentQuebec" style="margin-bottom:10px;">
    <option value="0">Aucun</option>
    <option value="10">Li√© au ressortissant √©tranger</option>
    <option value="5">Li√© au conjoint</option>
  </select>

  <button type="button" onclick="calculerPointsAdaptation()">Calculer les points Facteurs d‚Äôadaptation</button>
  <div id="resultat-adaptation"></div>
</div>
<div class="card" id="section-conjoint" style="display:none;">
  <h3 style="font-size:1.2em;margin-bottom:0.5em;">Crit√®res li√©s √† l‚Äô√©poux ou conjoint de fait</h3>
  
  <label for="frCompOraleConj">Compr√©hension orale du conjoint</label>
  <select id="frCompOraleConj">
    <option value="0">Niveau 1 √† 3</option>
    <option value="4">Niveau 4</option>
    <option value="6">Niveau 5 ou 6</option>
    <option value="8">Niveau 7 ou 8</option>
    <option value="10">Niveau 9 √† 12</option>
  </select>

  <label for="frProdOraleConj">Production orale du conjoint</label>
  <select id="frProdOraleConj">
    <option value="0">Niveau 1 √† 3</option>
    <option value="4">Niveau 4</option>
    <option value="6">Niveau 5 ou 6</option>
    <option value="8">Niveau 7 ou 8</option>
    <option value="10">Niveau 9 √† 12</option>
  </select>

  <label for="frCompEcritConj">Compr√©hension √©crite du conjoint</label>
  <select id="frCompEcritConj">
    <option value="0">Niveau 1 √† 3</option>
    <option value="4">Niveau 4</option>
    <option value="6">Niveau 5 ou 6</option>
    <option value="8">Niveau 7 ou 8</option>
    <option value="10">Niveau 9 √† 12</option>
  </select>

  <label for="frProdEcritConj">Production √©crite du conjoint</label>
  <select id="frProdEcritConj">
    <option value="0">Niveau 1 √† 3</option>
    <option value="4">Niveau 4</option>
    <option value="6">Niveau 5 ou 6</option>
    <option value="8">Niveau 7 ou 8</option>
    <option value="10">Niveau 9 √† 12</option>
  </select>

  <label for="ageConj">√Çge du conjoint</label>
  <select id="ageConj">
    <option value="18">16 √† 19 ans</option>
    <option value="20">20 √† 30 ans</option>
    <option value="18">31 ans</option>
    <option value="17">32 ans</option>
    <option value="16">33 ans</option>
    <option value="15">34 ans</option>
    <option value="14">35 ans</option>
    <option value="12">36 ans</option>
    <option value="10">37 ans</option>
    <option value="8">38 ans</option>
    <option value="7">39 ans</option>
    <option value="6">40 ans</option>
    <option value="5">41 ans</option>
    <option value="4">42 ans</option>
    <option value="3">43 ans</option>
    <option value="2">44 ans</option>
    <option value="0">45 ans ou plus</option>
  </select>

  <label for="expQcConj">Exp√©rience de travail au Qu√©bec du conjoint (5 derni√®res ann√©es)</label>
  <select id="expQcConj">
    <option value="0">0 √† 5 mois</option>
    <option value="5">6 √† 11 mois</option>
    <option value="10">12 √† 23 mois</option>
    <option value="15">24 √† 35 mois</option>
    <option value="23">36 √† 47 mois</option>
    <option value="30">48 √† 60 mois</option>
  </select>

  <label for="scolariteConj">Niveau de scolarit√© du conjoint</label>
  <select id="scolariteConj">
    <option value="2">Secondaire g√©n√©ral compl√©t√©</option>
    <option value="2">Secondaire professionnel 600 √† 899h (QC)</option>
    <option value="4">Secondaire professionnel 900h+ (QC)</option>
    <option value="4">Secondaire professionnel 1 an+ (hors QC)</option>
    <option value="6">Postsecondaire g√©n√©ral 2 ans (temps plein)</option>
    <option value="8">Postsecondaire technique 900h+ (QC)</option>
    <option value="8">Postsecondaire technique 1 ou 2 ans (hors QC)</option>
    <option value="12">Postsecondaire technique 3 ans (temps plein)</option>
    <option value="12">Universitaire 1er cycle 1 an (temps plein)</option>
    <option value="14">Universitaire 1er cycle 2 ans (temps plein)</option>
    <option value="16">Universitaire 1er cycle 3 ou 4 ans (temps plein)</option>
    <option value="17">Universitaire 1er cycle 5 ans ou plus (temps plein)</option>
    <option value="17">Universitaire 2e cycle 1 an (temps plein)</option>
    <option value="18">Universitaire 2e cycle 2 ans ou plus (temps plein)</option>
    <option value="20">Universitaire sp√©cialisation m√©dicale (2 ans ou plus)</option>
    <option value="20">Universitaire 3e cycle</option>
  </select>

  <label for="diplomeQcConj">Dipl√¥me du Qu√©bec du conjoint</label>
  <select id="diplomeQcConj">
    <option value="0">Aucun</option>
    <option value="3">Secondaire g√©n√©ral compl√©t√©</option>
    <option value="3">Secondaire professionnel 600 √† 899h</option>
    <option value="6">Secondaire professionnel 900h+ (QC)</option>
    <option value="9">Postsecondaire g√©n√©ral 2 ans (temps plein)</option>
    <option value="12">Postsecondaire technique 900h+ (QC)</option>
    <option value="18">Postsecondaire technique 3 ans (temps plein)</option>
    <option value="18">Universitaire 1er cycle 1 an (temps plein)</option>
    <option value="21">Universitaire 1er cycle 2 ans (temps plein)</option>
    <option value="24">Universitaire 1er cycle 3 ou 4 ans (temps plein)</option>
    <option value="25">Universitaire 1er cycle 5 ans ou plus (temps plein)</option>
    <option value="25">Universitaire 2e cycle 1 an (temps plein)</option>
    <option value="27">Universitaire 2e cycle 2 ans ou plus (temps plein)</option>
    <option value="30">Universitaire sp√©cialisation m√©dicale (2 ans ou plus)</option>
    <option value="30">Universitaire 3e cycle</option>
  </select>

  <button type="button" onclick="calculerPointsConjoint()">Calculer les points Conjoint</button>
  <div id="resultat-conjoint"></div>
</div>

    <div id="score-total"></div>
    
     <button type="button" onclick="calculerTout()">
      Calculer le score global
    </button>
    
    <button type="button" onclick="resetAll()">
  R√©initialiser
</button>
<div style="
  background: linear-gradient(95deg,#f5f7fa 50%, #e0e7ff 100%);
  border-radius: 1.3em;
  box-shadow: 0 2px 18px #0002;
  max-width: 680px;
  margin: 46px auto 28px auto;
  padding: 34px 18px 30px 18px;
  text-align: center;
  border: 2.5px solid #3b82f6;
  ">
  <div style="font-size: 1.15em; color: #2563eb; font-weight: bold; letter-spacing:0.5px;">
    üöÄ <span style="text-transform:uppercase;">Maximisez vos chances au PSTQ</span> üöÄ
  </div>
  <div style="font-size: 2.1em; font-weight: 800; color: #1e293b; margin: 0.6em 0 0.38em 0; line-height:1.16;">
    Obtenez votre √©valuation <span style="color:#2563eb;">PSTQ</span> <br>
    avec un consultant officiel <span style="font-size:0.7em;">(RCIC)</span>
  </div>
  <div style="font-size:1.16em; color:#334155; margin-bottom:1.4em;">
    Un accompagnement sur-mesure pour<br>optimiser votre dossier et <b>faire votre demande PSTQ</b>.<br>
  </div>
  <a href="https://visacanadarouge.com/consultation/" target="_blank"
    style="
      display:inline-block;
      background:linear-gradient(90deg,#ef4444,#2563eb 80%);
      color:#fff;
      font-weight:700;
      letter-spacing:1.2px;
      padding:18px 55px;
      border-radius: 9px;
      font-size:1.22em;
      box-shadow:0 3px 16px #2563eb3a;
      transition:background 0.23s, box-shadow 0.23s, transform 0.18s;
      text-decoration:none;
      text-shadow:0 1px 7px #1e293b21;
    "
    onmouseover="this.style.transform='scale(1.04)';"
    onmouseout="this.style.transform='scale(1)';"
  >
    üíº Prendre mon rendez-vous PSTQ
  </a>
  <div style="font-size:0.99em; color:#64748b; margin-top:1.1em;">
    <b>Visa Canada Rouge</b> ‚Äì Montr√©al, Qu√©bec<br>
  </div>
</div>
Clause de non-responsabilit√©‚ÄØ:
Ce calculateur d‚Äô√©ligibilit√© au PSTQ est propos√© uniquement √† titre indicatif et n‚Äôa aucune valeur l√©gale ou officielle. Les r√©sultats sont des estimations qui ne garantissent en aucun cas l‚Äôobtention d‚Äôun score ou d‚Äôune d√©cision positive de la part des autorit√©s d‚Äôimmigration du Qu√©bec.

Pour une √©valuation compl√®te, personnalis√©e et conforme √† votre situation, veuillez consulter un conseiller r√©glement√© en immigration.

Visa Canada Rouge d√©cline toute responsabilit√© li√©e √† l‚Äôutilisation de cet outil ou aux cons√©quences d‚Äôune d√©cision prise sur la base de ces r√©sultats.


  </div>

  <script>
    // === SECTION MAPPING CNP ===
    // Mets ici tous tes codes (exemple ci-dessous, √† compl√©ter avec ton mapping officiel !)
    const cnpDiagnostics = {
     "00010": "Non publi√©",
  "00011": "Non publi√©",
  "00012": "Non publi√©",
  "00013": "Non publi√©",
  "00014": "Non publi√©",
  "00015": "Non publi√©",
  "10010": "L√©ger D√©ficit",
  "10011": "L√©ger D√©ficit",
  "10012": "L√©ger D√©ficit",
  "10019": "L√©ger D√©ficit",
  "10020": "L√©ger D√©ficit",
  "10021": "√âquilibre",
  "10022": "√âquilibre",
  "10029": "√âquilibre",
  "10030": "√âquilibre",
  "11100": "L√©ger D√©ficit",
  "11101": "√âquilibre",
  "11102": "L√©ger D√©ficit",
  "11103": "√âquilibre",
  "11109": "√âquilibre",
"11200": "L√©ger D√©ficit",
  "11201": "L√©ger D√©ficit",
  "11202": "L√©ger D√©ficit",
  "12010": "√âquilibre",
  "12011": "√âquilibre",
  "12012": "√âquilibre",
  "12013": "√âquilibre",
  "12100": "√âquilibre",
  "12101": "L√©ger D√©ficit",
  "12102": "L√©ger D√©ficit",
  "12103": "√âquilibre",
  "12104": "√âquilibre",
  "12110": "√âquilibre",
  "12111": "L√©ger D√©ficit",
  "12112": "√âquilibre",
  "12113": "√âquilibre",
  "12200": "L√©ger D√©ficit",
  "12201": "L√©ger D√©ficit",
  "12202": "L√©ger D√©ficit",
  "12203": "L√©ger D√©ficit",
  "13100": "L√©ger D√©ficit",
  "13101": "L√©ger D√©ficit",
  "13102": "√âquilibre",
  "13110": "L√©ger D√©ficit",
  "13111": "L√©ger D√©ficit",
  "13112": "D√©ficit",
  "13200": "√âquilibre",
  "13201": "L√©ger D√©ficit",
  "14100": "√âquilibre",
  "14101": "√âquilibre",
  "14102": "√âquilibre",
  "14103": "√âquilibre",
  "14110": "√âquilibre",
  "14111": "L√©ger Surplus",
  "14112": "Non publi√©",
  "14200": "√âquilibre",
  "14201": "√âquilibre",
  "14202": "√âquilibre",
  "14300": "√âquilibre",
  "14301": "√âquilibre",
  "14400": "√âquilibre",
  "14401": "L√©ger D√©ficit",
  "14402": "√âquilibre",
  "14403": "L√©ger D√©ficit",
  "14404": "L√©ger D√©ficit",
  "14405": "L√©ger D√©ficit",
"20010": "L√©ger D√©ficit",
  "20011": "√âquilibre",
  "20012": "L√©ger D√©ficit",
  "21100": "√âquilibre",
  "21101": "L√©ger D√©ficit",
  "21102": "L√©ger D√©ficit",
  "21103": "Non publi√©",
  "21109": "Non publi√©",
  "21110": "L√©ger D√©ficit",
  "21111": "L√©ger D√©ficit",
  "21112": "L√©ger D√©ficit",
  "21120": "√âquilibre",
  "21200": "L√©ger D√©ficit",
  "21201": "L√©ger D√©ficit",
  "21202": "L√©ger D√©ficit",
  "21203": "L√©ger D√©ficit",
  "21210": "L√©ger D√©ficit",
  "21211": "L√©ger D√©ficit",
  "21220": "L√©ger D√©ficit",
  "21221": "L√©ger D√©ficit",
  "21222": "D√©ficit",
  "21223": "D√©ficit",
  "21230": "L√©ger D√©ficit",
  "21231": "D√©ficit",
  "21232": "D√©ficit",
  "21233": "√âquilibre",
  "21234": "L√©ger D√©ficit",
  "21300": "D√©ficit",
  "21301": "D√©ficit",
  "21310": "L√©ger D√©ficit",
  "21311": "L√©ger D√©ficit",
  "21320": "L√©ger D√©ficit",
  "21321": "L√©ger D√©ficit",
  "21322": "L√©ger D√©ficit",
  "21330": "√âquilibre",
  "21331": "√âquilibre",
  "21332": "Non publi√©",
"21390": "L√©ger D√©ficit",
  "21399": "Non publi√©",
  "22100": "D√©ficit",
  "22101": "L√©ger D√©ficit",
  "22110": "L√©ger D√©ficit",
  "22111": "√âquilibre",
  "22112": "L√©ger D√©ficit",
  "22113": "√âquilibre",
  "22114": "L√©ger D√©ficit",
"22210": "√âquilibre",
  "22211": "L√©ger D√©ficit",
  "22212": "L√©ger D√©ficit",
  "22213": "√âquilibre",
  "22214": "√âquilibre",
  "22220": "L√©ger D√©ficit",
  "22221": "L√©ger D√©ficit",
  "22222": "L√©ger D√©ficit",
  "22230": "L√©ger D√©ficit",
  "22231": "√âquilibre",
  "22232": "L√©ger D√©ficit",
  "22233": "L√©ger D√©ficit",
  "22300": "D√©ficit",
  "22301": "D√©ficit",
  "22302": "D√©ficit",
  "22303": "L√©ger D√©ficit",
  "22310": "D√©ficit",
  "22311": "√âquilibre",
  "22312": "D√©ficit",
  "22313": "L√©ger D√©ficit",
"30010": "√âquilibre",
  "31100": "D√©ficit",
  "31101": "L√©ger D√©ficit",
  "31102": "D√©ficit",
  "31103": "D√©ficit",
  "31110": "L√©ger D√©ficit",
  "31111": "√âquilibre",
  "31112": "D√©ficit",
  "31120": "D√©ficit",
  "31121": "L√©ger D√©ficit",
  "31200": "D√©ficit",
  "31201": "√âquilibre",
  "31202": "D√©ficit",
  "31203": "D√©ficit",
  "31204": "√âquilibre",
  "31209": "√âquilibre",
  "31300": "L√©ger D√©ficit",
  "31301": "D√©ficit",
  "31302": "D√©ficit",
  "31303": "D√©ficit",
  "32100": "L√©ger D√©ficit",
  "32101": "L√©ger D√©ficit",
  "32102": "L√©ger D√©ficit",
  "32103": "D√©ficit",
  "32104": "L√©ger D√©ficit",
  "32109": "Non publi√©",
"32110": "√âquilibre",
  "32111": "D√©ficit",
  "32112": "L√©ger D√©ficit",
  "32120": "D√©ficit",
  "32121": "D√©ficit",
  "32122": "L√©ger D√©ficit",
  "32123": "D√©ficit",
  "32124": "L√©ger D√©ficit",
  "32129": "L√©ger D√©ficit",
  "32200": "Non publi√©",
  "32201": "√âquilibre",
  "32209": "Non publi√©",
  "33100": "√âquilibre",
  "33101": "L√©ger D√©ficit",
  "33102": "L√©ger D√©ficit",
  "33103": "L√©ger D√©ficit",
  "33109": "Non publi√©",
"40010": "Non publi√©",
  "40011": "Non publi√©",
  "40012": "Non publi√©",
  "40019": "Non publi√©",
  "40020": "√âquilibre",
  "40021": "√âquilibre",
  "40030": "L√©ger D√©ficit",
  "40040": "Non publi√©",
  "40041": "Non publi√©",
  "40042": "Non publi√©",
  "41100": "Non publi√©",
  "41101": "L√©ger D√©ficit",
  "41200": "√âquilibre",
  "41201": "√âquilibre",
  "41210": "√âquilibre",
  "41220": "D√©ficit",
  "41221": "D√©ficit",
  "41300": "D√©ficit",
  "41301": "D√©ficit",
  "41302": "Non publi√©",
  "41310": "√âquilibre",
  "41311": "√âquilibre",
  "41320": "L√©ger D√©ficit",
  "41321": "L√©ger D√©ficit",
"41400": "√âquilibre",
  "41401": "√âquilibre",
  "41402": "√âquilibre",
  "41403": "√âquilibre",
  "41404": "L√©ger D√©ficit",
  "41405": "L√©ger D√©ficit",
  "41406": "√âquilibre",
  "41407": "√âquilibre",
  "41409": "Non publi√©",
  "42100": "L√©ger D√©ficit",
  "42101": "L√©ger Surplus",
  "42102": "Non publi√©",
  "42200": "√âquilibre",
  "42201": "D√©ficit",
  "42202": "D√©ficit",
  "42203": "D√©ficit",
  "42204": "Non publi√©",
 "43100": "L√©ger D√©ficit",
  "43109": "Non publi√©",
  "43200": "√âquilibre",
  "43201": "L√©ger D√©ficit",
  "43202": "√âquilibre",
  "43203": "√âquilibre",
  "43204": "Non publi√©",
  "44100": "L√©ger D√©ficit",
  "44101": "D√©ficit",
  "44200": "Non publi√©",
"45100": "L√©ger D√©ficit",
  "50010": "√âquilibre",
  "50011": "√âquilibre",
  "50012": "√âquilibre",
  "51100": "√âquilibre",
  "51101": "√âquilibre",
  "51102": "√âquilibre",
  "51110": "√âquilibre",
  "51111": "Non publi√©",
  "51112": "Non publi√©",
  "51113": "L√©ger Surplus",
  "51114": "√âquilibre",
  "51120": "L√©ger D√©ficit",
  "51121": "Non publi√©",
  "51122": "Non publi√©",
  "52100": "√âquilibre",
  "52110": "√âquilibre",
  "52111": "√âquilibre",
  "52112": "Non publi√©",
  "52113": "L√©ger D√©ficit",
  "52114": "√âquilibre",
  "52119": "Non publi√©",
  "52120": "L√©ger D√©ficit",
  "52121": "√âquilibre",
  "53100": "√âquilibre",
  "53110": "L√©ger Surplus",
  "53111": "L√©ger D√©ficit",
  "53120": "Non publi√©",
  "53121": "Non publi√©",
  "53122": "Non publi√©",
  "53123": "√âquilibre",
  "53124": "Non publi√©",
  "53125": "L√©ger D√©ficit",
  "53200": "Non publi√©",
  "53201": "Non publi√©",
  "53202": "Non publi√©",
  "54100": "L√©ger D√©ficit",
  "55109": "Non publi√©",
"60010": "L√©ger D√©ficit",
  "60020": "√âquilibre",
  "60030": "L√©ger D√©ficit",
  "60031": "√âquilibre",
  "60040": "Non publi√©",
  "62010": "√âquilibre",
  "62020": "D√©ficit",
  "62021": "Non publi√©",
  "62022": "√âquilibre",
  "62023": "√âquilibre",
  "62024": "√âquilibre",
  "62029": "Non publi√©",
  "62100": "L√©ger D√©ficit",
  "62101": "√âquilibre",
  "62200": "L√©ger D√©ficit",
  "62201": "√âquilibre",
  "62202": "L√©ger Surplus",
  "63100": "L√©ger D√©ficit",
  "63101": "L√©ger Surplus",
  "63102": "√âquilibre",
  "63200": "D√©ficit",
  "63201": "L√©ger D√©ficit",
  "63202": "L√©ger D√©ficit",
  "63210": "√âquilibre",
  "63211": "√âquilibre",
  "63220": "L√©ger D√©ficit",
  "63221": "L√©ger D√©ficit",
  "64100": "L√©ger D√©ficit",
  "64101": "L√©ger D√©ficit",
  "64200": "L√©ger D√©ficit",
  "64201": "Non publi√©",
  "64300": "√âquilibre",
  "64301": "√âquilibre",
  "64310": "√âquilibre",
  "64311": "√âquilibre",
  "64312": "√âquilibre",
  "64313": "√âquilibre",
  "64314": "√âquilibre",
  "64320": "√âquilibre",
  "64321": "√âquilibre",
  "64322": "√âquilibre",
  "64400": "√âquilibre",
  "64401": "√âquilibre",
  "64409": "L√©ger D√©ficit",
  "64410": "L√©ger D√©ficit",
  "65100": "L√©ger D√©ficit",
  "65101": "√âquilibre",
  "65102": "L√©ger D√©ficit",
  "65109": "√âquilibre",
  "65200": "L√©ger D√©ficit",
  "65201": "D√©ficit",
  "65202": "L√©ger D√©ficit",
  "65210": "√âquilibre",
  "65211": "√âquilibre",
  "65220": "√âquilibre",
  "65229": "Non publi√©",
"65310": "L√©ger D√©ficit",
  "65311": "L√©ger D√©ficit",
  "65312": "√âquilibre",
  "65320": "L√©ger D√©ficit",
  "65329": "Non publi√©",
  "70010": "√âquilibre",
  "70011": "√âquilibre",
  "70012": "√âquilibre",
  "70020": "√âquilibre",
  "70021": "√âquilibre",
  "72010": "√âquilibre",
  "72011": "√âquilibre",
  "72012": "√âquilibre",
  "72013": "√âquilibre",
  "72014": "√âquilibre",
  "72020": "L√©ger D√©ficit",
  "72021": "√âquilibre",
  "72022": "√âquilibre",
  "72023": "Non publi√©",
  "72024": "√âquilibre",
  "72025": "√âquilibre",
  "72100": "D√©ficit",
  "72101": "L√©ger D√©ficit",
  "72102": "L√©ger D√©ficit",
  "72103": "√âquilibre",
  "72104": "L√©ger D√©ficit",
  "72105": "L√©ger D√©ficit",
  "72106": "D√©ficit",
  "72200": "L√©ger D√©ficit",
  "72201": "L√©ger D√©ficit",
  "72202": "L√©ger D√©ficit",
  "72203": "L√©ger D√©ficit",
  "72204": "L√©ger D√©ficit",
  "72205": "√âquilibre",
  "72300": "L√©ger D√©ficit",
  "72301": "L√©ger D√©ficit",
  "72302": "Non publi√©",
  "72310": "L√©ger D√©ficit",
  "72311": "L√©ger D√©ficit",
  "72320": "L√©ger D√©ficit",
  "72321": "L√©ger D√©ficit",
  "72400": "D√©ficit",
  "72401": "D√©ficit",
  "72402": "L√©ger D√©ficit",
  "72403": "Non publi√©",
  "72404": "L√©ger D√©ficit",
  "72405": "L√©ger D√©ficit",
  "72406": "L√©ger D√©ficit",
  "72410": "D√©ficit",
  "72411": "D√©ficit",
  "72420": "Non publi√©",
  "72421": "L√©ger D√©ficit",
  "72422": "D√©ficit",
  "72423": "L√©ger D√©ficit",
  "72429": "L√©ger D√©ficit",
  "72500": "L√©ger D√©ficit",
  "72501": "Non publi√©",
  "72600": "L√©ger D√©ficit",
  "72601": "√âquilibre",
  "72602": "L√©ger D√©ficit",
  "72603": "L√©ger D√©ficit",
  "72604": "Non publi√©",
  "72999": "Non publi√©",
  "73100": "L√©ger D√©ficit",
  "73101": "L√©ger D√©ficit",
  "73102": "L√©ger D√©ficit",
  "73110": "L√©ger D√©ficit",
  "73111": "L√©ger D√©ficit",
  "73112": "L√©ger D√©ficit",
  "73113": "L√©ger D√©ficit",
  "73200": "L√©ger D√©ficit",
  "73201": "L√©ger D√©ficit",
  "73202": "√âquilibre",
  "73209": "Non publi√©",
  "73300": "D√©ficit",
  "73301": "L√©ger D√©ficit",
  "73310": "√âquilibre",
  "73311": "√âquilibre",
  "73400": "L√©ger D√©ficit",
  "73401": "L√©ger D√©ficit",
  "73402": "L√©ger D√©ficit",
  "74100": "√âquilibre",
  "74101": "√âquilibre",
  "74102": "√âquilibre",
  "74200": "√âquilibre",
  "74201": "L√©ger D√©ficit",
  "74202": "√âquilibre",
  "74203": "L√©ger D√©ficit",
  "74204": "Non publi√©",
  "74205": "√âquilibre",
  "75100": "√âquilibre",
  "75101": "L√©ger D√©ficit",
  "75110": "L√©ger D√©ficit",
  "75119": "Non publi√©",
  "75200": "√âquilibre",
  "75201": "L√©ger D√©ficit",
  "75210": "Non publi√©",
  "75211": "√âquilibre",
  "75212": "√âquilibre",
"80010": "√âquilibre",
  "80020": "L√©ger D√©ficit",
  "80021": "L√©ger D√©ficit",
  "80022": "Non publi√©",
  "82010": "√âquilibre",
  "82020": "√âquilibre",
  "82021": "Non publi√©",
  "82030": "L√©ger D√©ficit",
  "82031": "√âquilibre",
  "83100": "√âquilibre",
  "83101": "Non publi√©",
  "83110": "L√©ger D√©ficit",
  "83120": "Non publi√©",
  "83121": "√âquilibre",
  "84100": "√âquilibre",
  "84101": "Non publi√©",
  "84110": "L√©ger D√©ficit",
  "84111": "L√©ger D√©ficit",
  "84120": "D√©ficit",
  "84121": "√âquilibre",
  "85100": "L√©ger D√©ficit",
  "85101": "D√©ficit",
  "85102": "Non publi√©",
  "85103": "D√©ficit",
  "85104": "Non publi√©",
  "85110": "Non publi√©",
  "85111": "Non publi√©",
  "85120": "L√©ger D√©ficit",
  "85121": "D√©ficit",
  "90010": "L√©ger D√©ficit",
  "90011": "√âquilibre",
  "92010": "√âquilibre",
  "92011": "√âquilibre",
  "92012": "L√©ger D√©ficit",
  "92013": "L√©ger D√©ficit",
  "92014": "L√©ger D√©ficit",
  "92015": "L√©ger D√©ficit",
  "92020": "√âquilibre",
  "92021": "√âquilibre",
  "92022": "√âquilibre",
  "92023": "√âquilibre",
  "92024": "Non publi√©",
  "92100": "L√©ger D√©ficit",
  "92101": "L√©ger D√©ficit",
  "93100": "Non publi√©",
  "93101": "L√©ger D√©ficit",
  "93102": "Non publi√©",
  "93200": "L√©ger D√©ficit",
  "94100": "L√©ger D√©ficit",
  "94101": "L√©ger D√©ficit",
  "94102": "√âquilibre",
  "94103": "L√©ger D√©ficit",
  "94104": "√âquilibre",
  "94105": "L√©ger D√©ficit",
  "94106": "L√©ger D√©ficit",
  "94107": "L√©ger D√©ficit",
  "94110": "L√©ger D√©ficit",
  "94111": "L√©ger D√©ficit",
  "94112": "L√©ger D√©ficit",
  "94120": "L√©ger D√©ficit",
  "94121": "√âquilibre",
  "94122": "√âquilibre",
  "94123": "√âquilibre",
  "94124": "L√©ger D√©ficit",
  "94129": "√âquilibre",
  "94130": "L√©ger D√©ficit",
  "94131": "L√©ger D√©ficit",
  "94132": "L√©ger D√©ficit",
  "94133": "√âquilibre",
  "94140": "L√©ger D√©ficit",
  "94141": "L√©ger D√©ficit",
  "94142": "L√©ger D√©ficit",
  "94143": "L√©ger D√©ficit",
  "94150": "√âquilibre",
  "94151": "Non publi√©",
  "94152": "√âquilibre",
  "94153": "Non publi√©",
  "94200": "√âquilibre",
  "94201": "√âquilibre",
  "94202": "L√©ger D√©ficit",
  "94203": "L√©ger D√©ficit",
  "94204": "L√©ger D√©ficit",
  "94205": "L√©ger D√©ficit",
  "94210": "L√©ger D√©ficit",
  "94211": "L√©ger D√©ficit",
  "94212": "L√©ger D√©ficit",
  "94213": "L√©ger D√©ficit",
  "94219": "Non publi√©",
  "95100": "√âquilibre",
  "95101": "D√©ficit",
  "95102": "L√©ger D√©ficit",
  "95103": "D√©ficit",
  "95104": "L√©ger D√©ficit",
  "95105": "L√©ger D√©ficit",
  "95106": "D√©ficit",
  "95107": "D√©ficit",
  "95109": "Non publi√©"
      // ... COLLE ICI TON MAPPING COMPLET ...
    };

    // === Fonctions pour le Diagnostic ===
    function normalizeDiagnostic(str) {
  if (!str) return "non_publie";
  str = str.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
  if (str.includes("deficit") && !str.includes("leger")) return "deficit";
  if (str.includes("leger") && str.includes("deficit")) return "leger_deficit";
  if (str.includes("equilibre")) return "equilibre";
  if (str.includes("non publie")) return "non_publie";
  return "non_publie";
}
function getDiagnostic(cnp) {
  return normalizeDiagnostic(cnpDiagnostics[cnp]);
}
function pointsDiagnostic(diagnostic, mois) {
  if (diagnostic === "equilibre" || diagnostic === "non_publie") {
    if (mois < 12) return 0;
    if (mois < 24) return 5;
    if (mois < 36) return 10;
    if (mois < 48) return 15;
    return 25;
  }
  if (diagnostic === "leger_deficit") {
    if (mois < 12) return 0;
    if (mois < 24) return 70;
    if (mois < 36) return 80;
    if (mois < 48) return 90;
    return 100;
  }
  if (diagnostic === "deficit") {
    if (mois < 12) return 0;
    if (mois < 24) return 90;
    if (mois < 36) return 100;
    if (mois < 48) return 110;
    return 120;
  }
  return 0;
}
    let scoreDiagnostic = 0;

    function calculerPointsDiagnostic() {
      const cnp = document.getElementById('cnp').value.trim();
      const mois = parseInt(document.getElementById('experienceDiagnostic').value, 10);
      const diagnostic = getDiagnostic(cnp);

      let diagnosticLabel = {
        "equilibre": "√âquilibre",
        "leger_deficit": "L√©ger d√©ficit",
        "deficit": "D√©ficit",
        "non_publie": "Non publi√©"
      }[diagnostic] || "Non publi√©";

      const points = pointsDiagnostic(diagnostic, mois);
      scoreDiagnostic = points;

      let color = "#2563eb";
      if (diagnostic === "deficit") color = "#e11d48";
      else if (diagnostic === "leger_deficit") color = "#f59e42";
      else if (diagnostic === "equilibre") color = "#16a34a";
      else color = "#64748b";

      document.getElementById('resultat-diagnostic').innerHTML =
        `<div style="padding:0.5em 0;">
          <b>Diagnostic :</b> <span style="color:${color};font-weight:bold;">${diagnosticLabel}</span><br>
          <b>Points selon la dur√©e d'exp√©rience :</b> <span style="color:${color};font-weight:bold;">${points} / 120</span>
        </div>`;

      calculerScoreTotal(); // Met √† jour le total quand tu cliques "Calculer"
    }

    // === Formulaire Capital humain (rien √† toucher ici) ===
    function renderCapitalHumain() {
         // 1) R√©initialisation compl√®te des scores
  scoreCapitalHumain = 0;
  scoreDiagnostic     = 0;
  scoreQC             = 0;
  scoreOffre          = 0;
  scoreAdaptation     = 0;
  scoreConjoint       = 0;

  // 2) Vidage des r√©sultats interm√©diaires
  document.getElementById('result').innerText = '';
  document.getElementById('resultat-diagnostic').innerHTML = '';
  document.getElementById('resultat-qc').innerHTML = '';
  document.getElementById('resultat-offre').innerHTML = '';
  document.getElementById('resultat-adaptation').innerHTML = '';
  document.getElementById('resultat-conjoint').innerHTML = '';

  // 3) Affichage du score total √† z√©ro
  calculerScoreTotal();
  
      const avecConjoint = document.getElementById("avecConjoint").value === "oui";
      const form = document.getElementById("capitalHumain");
      form.innerHTML = '';

      const frenchLevels = [
        { label: 'Niveau 1 √† 4', value: 0 },
        { label: 'Niveau 5 ou 6', value: avecConjoint ? 30 : 38 },
        { label: 'Niveau 7 ou 8', value: avecConjoint ? 35 : 44 },
        { label: 'Niveau 9 √† 12', value: avecConjoint ? 40 : 50 }
      ];

      const buildSelect = (id, label, options) => {
        return `
          <label for="${id}">${label}</label>
          <select id="${id}">
            ${options.map(o => `<option value="${o.value}">${o.label}</option>`).join('')}
          </select>
        `;
      };

      form.innerHTML += `<h2>Connaissance du fran√ßais</h2>`;
      form.innerHTML += buildSelect("comprOrale", "Compr√©hension orale", frenchLevels);
      form.innerHTML += buildSelect("prodOrale", "Production orale", frenchLevels);
      form.innerHTML += buildSelect("comprEcrite", "Compr√©hension √©crite", frenchLevels);
      form.innerHTML += buildSelect("prodEcrite", "Production √©crite", frenchLevels);

      const ageOptions = [
  ["18 √† 19 ans", avecConjoint ? 90 : 110],
  ["20 √† 30 ans", avecConjoint ? 100 : 120],
  ["31 ans",      avecConjoint ? 95 : 110],
  ["32 ans",      avecConjoint ? 90 : 100],
  ["33 ans",      avecConjoint ? 81 : 90],
  ["34 ans",      avecConjoint ? 72 : 80],
  ["35 ans",      avecConjoint ? 68 : 75],
  ["36 ans",      avecConjoint ? 63 : 70],
  ["37 ans",      avecConjoint ? 59 : 65],
  ["38 ans",      avecConjoint ? 54 : 60],
  ["39 ans",      avecConjoint ? 50 : 55],
  ["40 ans",      avecConjoint ? 45 : 50],
  ["41 ans",      avecConjoint ? 36 : 40],
  ["42 ans",      avecConjoint ? 27 : 30],
  ["43 ans",      avecConjoint ? 18 : 20],
  ["44 ans",      avecConjoint ?  9 : 10],
  ["45 ans ou plus", 0]
];
      form.innerHTML += `<h2>√Çge</h2>`;
      form.innerHTML += buildSelect("age", "S√©lectionnez votre groupe d'√¢ge", ageOptions.map(([label, value]) => ({label, value})));

      const expOptions = [
        ["Moins de 12 mois", 0],
        ["12 √† 23 mois", avecConjoint ? 15 : 20],
        ["24 √† 35 mois", avecConjoint ? 30 : 40],
        ["36 √† 47 mois", avecConjoint ? 35 : 50],
        ["48 mois et plus", avecConjoint ? 50 : 70]
      ];
      form.innerHTML += `<h2>Exp√©rience de travail General</h2>`;
      form.innerHTML += buildSelect("experience", "Dur√©e de l'exp√©rience (5 derni√®res ann√©es)", expOptions.map(([label, value]) => ({label, value})));

      const educOptions = [
        ["Secondaire g√©n√©ral compl√©t√©", avecConjoint ? 11 : 13],
        ["Secondaire professionnel 600 √† 899h (QC)", avecConjoint ? 11 : 13],
        ["Secondaire professionnel 900h+ (QC)", avecConjoint ? 22 : 26],
        ["Secondaire professionnel 1 an+ (hors QC)", avecConjoint ? 22 : 26],
        ["Postsecondaire g√©n√©ral 2 ans (temps plein)", avecConjoint ? 33 : 39],
        ["Postsecondaire technique 900h+ (QC)", avecConjoint ? 44 : 52],
        ["Postsecondaire technique 1 ou 2 ans (hors QC)", avecConjoint ? 44 : 52],
        ["Postsecondaire technique 3 ans", avecConjoint ? 66 : 78],
        ["Universitaire 1er cycle 1 an", avecConjoint ? 66 : 78],
        ["Universitaire 1er cycle 2 ans", avecConjoint ? 77 : 91],
        ["Universitaire 1er cycle 3-4 ans", avecConjoint ? 88 : 104],
        ["Universitaire 1er cycle 5 ans ou plus", avecConjoint ? 93 : 110],
        ["Universitaire 2e cycle 1 an", avecConjoint ? 93 : 110],
        ["Universitaire 2e cycle 2 ans ou plus", avecConjoint ? 99 : 117],
        ["Universitaire sp√©cialisation m√©dicale ou 3e cycle", avecConjoint ? 110 : 130]
      ];
      form.innerHTML += `<h2>Niveau de scolarit√©</h2>`;
      form.innerHTML += buildSelect("education", "Votre dipl√¥me principal compl√©t√©", educOptions.map(([label, value]) => ({label, value})));

      form.innerHTML += '<button type="button" onclick="calculateCapitalHumain()">Calculer les points Capital humain</button>';
      // Affiche/masque la section conjoint selon la s√©lection
const sectionConjoint = document.getElementById("section-conjoint");
if (sectionConjoint) {
  sectionConjoint.style.display = (document.getElementById("avecConjoint").value === "oui") ? "" : "none";
}
if (!avecConjoint) {
  scoreConjoint = 0;
  document.getElementById('resultat-conjoint').innerHTML = "";
  calculerScoreTotal();
}
    }

    let scoreCapitalHumain = 0;

    function calculateCapitalHumain() {
  const fields = ["comprOrale", "prodOrale", "comprEcrite", "prodEcrite", "age", "experience", "education"];
  let total = 0;
  for (const id of fields) {
    total += parseInt(document.getElementById(id).value, 10) || 0;
  }
  scoreCapitalHumain = total;

  // D√©termine le maximum selon qu'on a un conjoint ou pas
  const avecConjoint = document.getElementById("avecConjoint").value === "oui";
  const maxCapital = avecConjoint ? 420 : 520;

  // Affiche le r√©sultat avec le bon d√©nominateur
  document.getElementById("result").innerText =
    `Total points ‚Äì Capital humain : ${total} / ${maxCapital}`;

  // Met √† jour le score global
  calculerScoreTotal();
}

    // Initialisation √† l'ouverture de la page
    window.onload = renderCapitalHumain;
    
    function pointsDiplomeQC(type) {
  const table = {
    "secondaire": 20,
    "dep_600_899": 20,
    "dep_900": 40,
    "postsec_gen_2": 60,
    "postsec_tech_900": 80,
    "postsec_tech_3": 120,
    "univ_1an": 120,
    "univ_2an": 140,
    "univ_3_4an": 160,
    "univ_5an": 170,
    "univ_2e_1an": 170,
    "univ_2e_2an": 180,
    "univ_med_2an": 200,
    "univ_3e": 200
  };
  return table[type] || 0;
}

function pointsExpQC(mois) {
  mois = parseInt(mois, 10);
  if (mois < 12) return 0;
  if (mois < 24) return 40;
  if (mois < 36) return 80;
  if (mois < 48) return 120;
  return 160;
}

function pointsResidHorsMontr(mois) {
  mois = parseInt(mois, 10);
  if (mois < 6) return 0;
  if (mois < 12) return 6;
  if (mois < 24) return 16;
  if (mois < 36) return 24;
  if (mois < 48) return 32;
  return 40;
}

function pointsTravHorsMontr(mois) {
  mois = parseInt(mois, 10);
  if (mois < 6) return 0;
  if (mois < 12) return 9;
  if (mois < 24) return 24;
  if (mois < 36) return 36;
  if (mois < 48) return 48;
  return 60;
}

function pointsEtudHorsMontr(mois) {
  mois = parseInt(mois, 10);
  if (mois < 6) return 0;
  if (mois < 12) return 3;
  if (mois < 24) return 8;
  if (mois < 36) return 12;
  if (mois < 48) return 16;
  return 20;
}

let scoreQC = 0;

function calculerPointsQC() {
  const diplome = document.getElementById("diplomeQC").value;
  const expQC = document.getElementById("expQC").value;
  const resid = document.getElementById("residHorsMtl").value;
  const trav = document.getElementById("travHorsMtl").value;
  const etud = document.getElementById("etudHorsMtl").value;

  const ptsDiplome = pointsDiplomeQC(diplome);
  const ptsExpQC = pointsExpQC(expQC);
  const ptsResid = pointsResidHorsMontr(resid);
  const ptsTrav = pointsTravHorsMontr(trav);
  const ptsEtud = pointsEtudHorsMontr(etud);

  scoreQC = ptsDiplome + ptsExpQC + ptsResid + ptsTrav + ptsEtud;

  document.getElementById("resultat-qc").innerHTML =
    `<div style="padding:0.5em 0;">
      <b>Points dipl√¥me du Qu√©bec :</b> ${ptsDiplome} / 200<br>
      <b>Points exp√©rience de travail au QC :</b> ${ptsExpQC} / 160<br>
      <b>Points r√©sidence hors Montr√©al :</b> ${ptsResid} / 40<br>
      <b>Points travail hors Montr√©al :</b> ${ptsTrav} / 60<br>
      <b>Points √©tudes hors Montr√©al :</b> ${ptsEtud} / 20<br>
      <b style="color:#4f46e5;">Total section Qu√©bec / hors Montr√©al : <span style="font-size:1.1em;">${scoreQC}</span> / 480</b>
    </div>`;

  calculerScoreTotal();
}
let scoreOffre = 0;

function pointsOffreValidee() {
  const val = document.getElementById("offreValidee").value;
  if (val === "hors_cmm") return 50;
  if (val === "cmm") return 30;
  return 0;
}

function pointsAutorisationExercer() {
  return parseInt(document.getElementById("autorisationExercer").value, 10);
}

function calculerPointsOffre() {
  const ptsOffre = pointsOffreValidee();
  const ptsAutorisation = pointsAutorisationExercer();
  scoreOffre = ptsOffre + ptsAutorisation;
  document.getElementById("resultat-offre").innerHTML =
    `<div style="padding:0.5em 0;">
      <b>Points offre d‚Äôemploi valid√©e :</b> ${ptsOffre} / 50<br>
      <b>Points autorisation d‚Äôexercer :</b> ${ptsAutorisation} / 50<br>
      <b style="color:#4f46e5;">Total section Offre/Autorisation : <span style="font-size:1.1em;">${scoreOffre}</span> / 100</b>
    </div>`;
  calculerScoreTotal();
}

let scoreAdaptation = 0;

// Fonction pour calculer la dur√©e du s√©jour sans dipl√¥me
function pointsSejourSansDiplome(type, mois) {
  mois = parseInt(mois, 10);
  if (type === "termine") {
    if (mois < 6) return 0;
    if (mois < 12) return 1;
    if (mois < 24) return 3;
    if (mois < 36) return 5;
    if (mois < 48) return 8;
    return 10;
  }
  if (type === "encours") {
    if (mois < 6) return 0;
    if (mois < 12) return 5;
    if (mois < 24) return 12;
    if (mois < 36) return 18;
    if (mois < 48) return 24;
    return 30;
  }
  return 0;
}

function calculerPointsAdaptation() {
  const type = document.getElementById("sejourType").value;
  const mois = document.getElementById("dureeSejour").value;
  const ptsSejour = pointsSejourSansDiplome(type, mois);

  const ptsParente = parseInt(document.getElementById("parentQuebec").value, 10);

  scoreAdaptation = ptsSejour + ptsParente;

  document.getElementById("resultat-adaptation").innerHTML =
    `<div style="padding:0.5em 0;">
      <b>Points s√©jour sans dipl√¥me :</b> ${ptsSejour} / 30<br>
      <b>Points membre parent√© au Qu√©bec :</b> ${ptsParente} / 10<br>
      <b style="color:#4f46e5;">Total section Adaptation : <span style="font-size:1.1em;">${scoreAdaptation}</span> / 40</b>
    </div>`;
  calculerScoreTotal();
}

let scoreConjoint = 0;

function calculerPointsConjoint() {
  // R√©cup√©rer toutes les valeurs de la section conjoint
  const frCompOrale = parseInt(document.getElementById("frCompOraleConj").value, 10);
  const frProdOrale = parseInt(document.getElementById("frProdOraleConj").value, 10);
  const frCompEcrit = parseInt(document.getElementById("frCompEcritConj").value, 10);
  const frProdEcrit = parseInt(document.getElementById("frProdEcritConj").value, 10);
  const age = parseInt(document.getElementById("ageConj").value, 10);
  const expQc = parseInt(document.getElementById("expQcConj").value, 10);
  const scolarite = parseInt(document.getElementById("scolariteConj").value, 10);
  const diplomeQc = parseInt(document.getElementById("diplomeQcConj").value, 10);

  // Additionne tous les points
  scoreConjoint =
    frCompOrale +
    frProdOrale +
    frCompEcrit +
    frProdEcrit +
    age +
    expQc +
    scolarite +
    diplomeQc;

  // Affiche le r√©sultat dans la section d√©di√©e
  document.getElementById("resultat-conjoint").innerHTML =
    `<div style="padding:0.5em 0;">
      <b>Points conjoint :</b> <span style="color:#2563eb;">${scoreConjoint}</span> / 110
    </div>`;

  calculerScoreTotal();
}
// Mets √† jour la somme totale (ajoute scoreQC √† ta fonction existante)
function calculerScoreTotal() {
  const total = (scoreCapitalHumain || 0)
    + (scoreDiagnostic || 0)
    + (scoreQC || 0)
    + (scoreOffre || 0)
    + (scoreAdaptation || 0)
    + (scoreConjoint || 0); // AJOUTE ICI

  document.getElementById('score-total').innerHTML =
    `<div style="margin-top:1em;"><b>Score estim√© total :</b> <span style="color:#4f46e5;font-size:1.3em;">${total}</span> points</div>`;
}

function calculerTout() {
  calculateCapitalHumain();
  calculerPointsDiagnostic();
  calculerPointsQC();
  calculerPointsOffre();
  calculerPointsAdaptation();
  if (document.getElementById('section-conjoint').style.display !== 'none') {
    calculerPointsConjoint();
  }
  // Un dernier coup de total pour √™tre s√ªr
  calculerScoreTotal();
}

function resetAll() {
  // 1) remettre le mode ¬´ Seul(e) ¬ª
  document.getElementById('avecConjoint').value = 'non';
  // 2) r√©initialiser les scores et l‚Äôaffichage
  scoreCapitalHumain = 0;
  scoreDiagnostic     = 0;
  scoreQC             = 0;
  scoreOffre          = 0;
  scoreAdaptation     = 0;
  scoreConjoint       = 0;
  document.getElementById('result').innerText             = '';
  document.getElementById('resultat-diagnostic').innerHTML = '';
  document.getElementById('resultat-qc').innerHTML         = '';
  document.getElementById('resultat-offre').innerHTML      = '';
  document.getElementById('resultat-adaptation').innerHTML = '';
  document.getElementById('resultat-conjoint').innerHTML   = '';
  calculerScoreTotal();

  // 3) r√©afficher le formulaire Capital humain au mode ¬´ Seul(e) ¬ª
  renderCapitalHumain();

  // 4) vider tous les selects fixes
  const ids = [
    'cnp', 'experienceDiagnostic',
    'diplomeQC','expQC','residHorsMtl','travHorsMtl','etudHorsMtl',
    'offreValidee','autorisationExercer',
    'sejourType','dureeSejour','parentQuebec'
  ];
  ids.forEach(id => {
    const el = document.getElementById(id);
    if (el.tagName === 'SELECT') el.selectedIndex = 0;
    else if (el.tagName === 'INPUT') el.value = '';
  });
}
  </script>
</body>
</html>
